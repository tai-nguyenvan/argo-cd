<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/modules/postgres/templates/deployment.yaml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/modules/postgres/templates/deployment.yaml" />
              <option name="originalContent" value="apiVersion: apps/v1&#10;kind: Deployment&#10;metadata:&#10;  name: {{ default &quot;postgres-blue&quot; .Values.fullnameOverride }}&#10;  # namespace intentionally omitted: ArgoCD / Helm will set destination namespace&#10;spec:&#10;  replicas: {{ default 1 .Values.replicaCount }}&#10;  selector:&#10;    matchLabels:&#10;      app: {{ default &quot;postgres-blue&quot; .Values.fullnameOverride }}&#10;  template:&#10;    metadata:&#10;      labels:&#10;        app: {{ default &quot;postgres-blue&quot; .Values.fullnameOverride }}&#10;    spec:&#10;      securityContext:&#10;        fsGroup: 999&#10;      initContainers:&#10;        - name: init-postgres-perms&#10;          image: busybox:1.35&#10;          command:&#10;            - sh&#10;            - -c&#10;            - |&#10;              mkdir -p /var/lib/postgresql/data/pgdata&#10;              chown -R 999:999 /var/lib/postgresql&#10;              chmod 700 /var/lib/postgresql/data/pgdata&#10;          securityContext:&#10;            runAsUser: 0&#10;          volumeMounts:&#10;            - name: data&#10;              mountPath: /var/lib/postgresql/data&#10;      containers:&#10;        - name: postgres&#10;          image: &quot;{{ .Values.image.repository }}:{{ .Values.image.tag }}&quot;&#10;          imagePullPolicy: {{ default &quot;IfNotPresent&quot; .Values.image.pullPolicy }}&#10;          # Render a single env array that always includes PGDATA and then&#10;          # either reads DB creds from a Secret or falls back to literal values.&#10;          {{- $pgdata := &quot;/var/lib/postgresql/data/pgdata&quot; }}&#10;          {{- if .Values.credentials.secret.enabled }}&#10;          {{- $s := .Values.credentials.secret.name }}&#10;          {{- printf &quot;env:\n  - name: PGDATA\n    value: \&quot;%s\&quot;\n  - name: POSTGRES_USER\n    valueFrom:\n      secretKeyRef:\n        name: %s\n        key: POSTGRES_USER\n  - name: POSTGRES_PASSWORD\n    valueFrom:\n      secretKeyRef:\n        name: %s\n        key: POSTGRES_PASSWORD\n  - name: POSTGRES_DB\n    valueFrom:\n      secretKeyRef:\n        name: %s\n        key: POSTGRES_DB\n&quot; $pgdata $s $s $s | nindent 10 }}&#10;          {{- else }}&#10;          {{- printf &quot;env:\n  - name: PGDATA\n    value: \&quot;%s\&quot;\n  - name: POSTGRES_USER\n    value: \&quot;%s\&quot;\n  - name: POSTGRES_PASSWORD\n    value: \&quot;%s\&quot;\n  - name: POSTGRES_DB\n    value: \&quot;%s\&quot;\n&quot; $pgdata .Values.postgresql.username .Values.postgresql.password .Values.postgresql.database | nindent 10 }}&#10;          {{- end }}&#10;          ports:&#10;            - containerPort: {{ default 5432 .Values.service.port }}&#10;          volumeMounts:&#10;            - name: data&#10;              mountPath: /var/lib/postgresql/data&#10;      volumes:&#10;        - name: data&#10;          persistentVolumeClaim:&#10;            claimName: {{ default &quot;postgres-pvc&quot; .Values.fullnameOverride }}&#10;" />
              <option name="updatedContent" value="apiVersion: apps/v1&#10;kind: Deployment&#10;metadata:&#10;  name: {{ default &quot;postgres-blue&quot; .Values.fullnameOverride }}&#10;  # namespace intentionally omitted: ArgoCD / Helm will set destination namespace&#10;spec:&#10;  replicas: {{ default 1 .Values.replicaCount }}&#10;  selector:&#10;    matchLabels:&#10;      app: {{ default &quot;postgres-blue&quot; .Values.fullnameOverride }}&#10;  template:&#10;    metadata:&#10;      labels:&#10;        app: {{ default &quot;postgres-blue&quot; .Values.fullnameOverride }}&#10;    spec:&#10;      securityContext:&#10;        fsGroup: 999&#10;      initContainers:&#10;        - name: init-postgres-perms&#10;          image: busybox:1.35&#10;          command:&#10;            - sh&#10;            - -c&#10;            - |&#10;              mkdir -p /var/lib/postgresql/data/pgdata&#10;              chown -R 999:999 /var/lib/postgresql&#10;              chmod 700 /var/lib/postgresql/data/pgdata&#10;          securityContext:&#10;            runAsUser: 0&#10;          volumeMounts:&#10;            - name: data&#10;              mountPath: /var/lib/postgresql/data&#10;      containers:&#10;        - name: postgres&#10;          image: &quot;{{ .Values.image.repository }}:{{ .Values.image.tag }}&quot;&#10;          imagePullPolicy: {{ default &quot;IfNotPresent&quot; .Values.image.pullPolicy }}&#10;          # Render a single env array that always includes PGDATA and then&#10;          # either reads DB creds from a Secret or falls back to literal values.&#10;          {{- $pgdata := &quot;/var/lib/postgresql/data/pgdata&quot; }}&#10;          {{- if .Values.credentials.secret.enabled }}&#10;          {{- $s := .Values.credentials.secret.name }}&#10;          {{- printf &quot;env:\n  - name: PGDATA\n    value: \&quot;%s\&quot;\n  - name: POSTGRES_USER\n    valueFrom:\n      secretKeyRef:\n        name: %s\n        key: POSTGRES_USER\n  - name: POSTGRES_PASSWORD\n    valueFrom:\n      secretKeyRef:\n        name: %s\n        key: POSTGRES_PASSWORD\n  - name: POSTGRES_DB\n    valueFrom:\n      secretKeyRef:\n        name: %s\n        key: POSTGRES_DB\n&quot; $pgdata $s $s $s | nindent 10 }}&#10;          {{- else }}&#10;          {{- printf &quot;env:\n  - name: PGDATA\n    value: \&quot;%s\&quot;\n  - name: POSTGRES_USER\n    value: \&quot;%s\&quot;\n  - name: POSTGRES_PASSWORD\n    value: \&quot;%s\&quot;\n  - name: POSTGRES_DB\n    value: \&quot;%s\&quot;\n&quot; $pgdata .Values.postgresql.username .Values.postgresql.password .Values.postgresql.database | nindent 10 }}&#10;          {{- end }}&#10;          ports:&#10;            - containerPort: {{ default 5432 .Values.service.port }}&#10;          volumeMounts:&#10;            - name: data&#10;              mountPath: /var/lib/postgresql/data&#10;      volumes:&#10;        - name: data&#10;          persistentVolumeClaim:&#10;            claimName: {{ default &quot;postgres-pvc&quot; .Values.fullnameOverride }}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>